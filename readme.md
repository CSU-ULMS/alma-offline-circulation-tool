# Alma Offline Circulation Tool

The offline circulation tool that Ex Libris provides functions best on a single circ station. Reconciling the transaction files generated by multiple circ stations can be difficult. For example, if an item is checked in on one station, then checked out on another, but the offline files are uploaded in the opposite order, errors occur.

While thinking about writing software to merge multiple offline circulation files for upload, it was decided that a central system would meet our library's needs better. We searched GitHub for ideas, and found that the University of Oregon Libraries had published a very simple system for this function with a Creative Commons Public Domain license. We forked source, customized it for PSU, loaded it on a server, and pushed the results to the PSU Library's Github.

## Our Environment and Assumptions

 * The offline circ server is online.
 * Library building's network is available (switches are on UPS, internal traffic will flow as long as there is power to the workstations.
 * All workstations that access offline circ have entries in their hosts file (/etc/hosts or c:\windows\system32\drivers\etc\hosts) for the offline circ server, incase DNS is unavailable.

## Software Description

 * Basic collection of PHP scripts.  
 * OS package dependency is php-mysqli.
 * Server backups are unnecessary.
 * Web server account has write access to somewhere in the server's filesystem.
 * Site is not accessible outside the library.

## Installation
 
 * Copy the files into the site.
 
   ```
   [user@recirc$] https://github.com/pdxlibrary/alma-offline-circulation-tool.git /var/www/html/offline-circ
   ```

 * Install the database. 
 
   ```
   mysql> create database alma_offline;  
   mysql> grant all privileges on alma_offline.* to offline_user identified by 'offline_pass';  
   mysql> flush privileges;  
   mysql> exit;  
   [user@recirc$] mysql -u offline_user -poffline_pass alma_offline < include/alma_offline.sql  
   ```

 * Copy the configuration file into place. 
 
   ```
   [user@recirc$] cp include/configuration_sample.php include/configuration.php  
   ```  

 * Configure the app.

   ```
   <?php
   $MAIN_TITLE    = 'Offline Circulation System';  
   $CONTACT_NAME  = 'Library Systems Team';  
   $CONTACT_EMAIL = 'help@our.edu';  
   $FOOTER_TEXT   = 'Report any issues to $CONTACT_NAME (<a href="mailto:$CONTACT_EMAIL">$CONTACT_EMAIL</a>).';  

   $LIBRARIES_ARRAY = array(  
       '---' => 'Choose a Library',  
       'MAIN' => 'Main Library',  
       'OTHER' => 'Other Library',  
   );  
  
   $DB_SERVER   = 'localhost';  
   $DB_USERNAME = 'offline_user';  
   $DB_PASSWORD = 'offline_pass';  
   $DB_NAME     = 'alma_offline';  
   $DB_TABLE    = 'transactions';  
   ?> 
   ```